<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" 
  
>
  <!-- The Head -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="PrimusC2 - New Release Update 5.0" />
<meta property="og:locale" content="en" />
<meta name="description" content="Time for another update for PrimusC2. It includes significant changes to the project in order to create a more stable baseline for upcoming updates." />
<meta property="og:description" content="Time for another update for PrimusC2. It includes significant changes to the project in order to create a more stable baseline for upcoming updates." />
<link rel="canonical" href="http://localhost:4000/posts/PrimusC2_update_5.0/" />
<meta property="og:url" content="http://localhost:4000/posts/PrimusC2_update_5.0/" />
<meta property="og:site_name" content=". .\Primusinterp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-16T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PrimusC2 - New Release Update 5.0" />
<meta name="twitter:site" content="@AlbertsenOliver" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-16T00:00:00+02:00","datePublished":"2024-09-16T00:00:00+02:00","description":"Time for another update for PrimusC2. It includes significant changes to the project in order to create a more stable baseline for upcoming updates.","headline":"PrimusC2 - New Release Update 5.0","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/PrimusC2_update_5.0/"},"url":"http://localhost:4000/posts/PrimusC2_update_5.0/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>PrimusC2 - New Release | Update 5.0 | . .\Primusinterp
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content=". .\Primusinterp">
<meta name="application-name" content=". .\Primusinterp">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      if (this.hasMode) {
        if (this.isDarkMode) {
          if (!this.isSysDarkPrefer) {
            this.setDark();
          }
        } else {
          if (this.isSysDarkPrefer) {
            this.setLight();
          }
        }
      }

      let self = this;

      /* always follow the system prefers */
      this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          if (self.isDarkMode) {
            if (!self.isSysDarkPrefer) {
              self.setDark();
            }
          } else {
            if (self.isSysDarkPrefer) {
              self.setLight();
            }
          }

          self.clearMode();
        }

        self.notify();
      });
    } /* constructor() */

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isSysDarkPrefer() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get isLightMode() {
      return this.mode === ModeToggle.LIGHT_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }

    /* get the current mode on screen */
    get modeStatus() {
      if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) {
        return ModeToggle.DARK_MODE;
      } else {
        return ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }

    /* Notify another plugins that the theme mode has changed */
    notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        if (this.isSysDarkPrefer) {
          if (this.isLightMode) {
            this.clearMode();
          } else {
            this.setLight();
          }
        } else {
          if (this.isDarkMode) {
            this.clearMode();
          } else {
            this.setDark();
          }
        }
      } else {
        if (this.isSysDarkPrefer) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    } /* flipMode() */
  } /* ModeToggle */

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
        
        <img src="/assets/img/revan_animated2.gif" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <div class="site-title">
      <a href="/">. .\Primusinterp</a>
    </div>
    <div class="site-subtitle fst-italic">An Offensive blog</div>
  </div>
  <!-- .profile-wrapper -->

  <ul class="nav flex-column flex-grow-1 w-100 ps-0">
    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
      <li class="nav-item">
        <a href="/categories/" class="nav-link">
          <i class="fa-fw fas fa-stream"></i>
          

          <span>CATEGORIES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/tags/" class="nav-link">
          <i class="fa-fw fas fa-tags"></i>
          

          <span>TAGS</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/archives/" class="nav-link">
          <i class="fa-fw fas fa-archive"></i>
          

          <span>ARCHIVES</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/C-Primusinterp-Whoami/" class="nav-link">
          <i class="fa-fw fas fa-info-circle"></i>
          

          <span>C:\PRIMUSINTERP> WHOAMI</span>
        </a>
      </li>
      <!-- .nav-item -->
    
      <li class="nav-item">
        <a href="/PrimusC2/" class="nav-link">
          <i class="fa-fw fas fa-info-circle"></i>
          

          <span>PRIMUSC2</span>
        </a>
      </li>
      <!-- .nav-item -->
    
  </ul>
  <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button class="mode-toggle btn" aria-label="Switch Mode">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/Primusinterp"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/AlbertsenOliver"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</div>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container px-xxl-5">
        <!-- The Top Bar -->

<div id="topbar-wrapper">
  <div
    id="topbar"
    class="container d-flex align-items-center justify-content-between h-100"
  >
    <span id="breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                Home
              </a>
            </span>

          
        
          
        
          
            
              <span>PrimusC2 - New Release | Update 5.0</span>
            

          
        
      
    </span>
    <!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </span>
    <span id="search-cancel">Cancel</span>
  </div>
</div>

        











<div class="row">
  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4">
    

    <div class="post px-1 px-md-2">
      

      
        
      
        <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->



  
  

  <!-- CDN URL -->
  

  <!-- Add image path -->
  

  
    
      
      
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  
    

    
    

    

    
    

    
    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    

    

    <!-- lazy-load images <https://github.com/aFarkas/lazysizes#readme> -->
    
    

    <!-- add image placeholder -->
    
      
    

    <!-- Bypass the HTML-proofer test -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        
      
    

    <!-- combine -->
    

  

  



<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- return -->




<h1 data-toc-skip>PrimusC2 - New Release | Update 5.0</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class=""
  data-ts="1726437600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Sep 16, 2024
</em>

    </span>

    <!-- lastmod date -->
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        <a href="https://twitter.com/AlbertsenOliver">Oliver Albertsen</a>
      
      </em>
    </span>

    <div>
      <!-- read time -->
      <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1030 words"
>
  <em>5 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <h2><a href="/assets/img/Primusc2.png" class="popup img-link "><img data-src="/assets/img/Primusc2.png" alt="Primusinterp's Github logo" class="lazyload" data-proofer-ignore></a></h2>
<p>Time for another update for PrimusC2. It includes significant changes to the project in order to create a more stable baseline for upcoming updates.</p>

<p><a href="https://github.com/Primusinterp/PrimusC2">PrimusC2 Github link</a></p>

<h2 id="whats-new"><span class="me-2">What’s new:</span><a href="#whats-new" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li>Migrated to using a DB 😎
    <ul>
      <li>Persistent sessions</li>
      <li>All logic use the DB for data retrieval and storage</li>
      <li>Almost got rid of the use of global vars and non-persistent data types</li>
    </ul>
  </li>
  <li>TCP implant disabled
    <ul>
      <li>Needs a complete rework</li>
    </ul>
  </li>
  <li>EXE, Shellcode and DLL compilation
    <ul>
      <li>Choose what format you want the payload in</li>
    </ul>
  </li>
  <li>Added Docker compatibility for easier use
    <ul>
      <li>No need for any dependency hell</li>
    </ul>
  </li>
  <li>Web GUI updated
    <ul>
      <li>Add notes to callbacks</li>
      <li>Fetch data from the DB</li>
      <li>Output Searcher</li>
      <li>Added more compile options</li>
      <li>Shows callback data</li>
    </ul>
  </li>
  <li>Implant updates
    <ul>
      <li>Returns more detailed windows version</li>
      <li>Steal_token</li>
      <li>rev2self</li>
      <li>whoami</li>
      <li>tShell</li>
      <li>Usercontext</li>
    </ul>
  </li>
  <li>CLI visual updates with “arrow menus”
    <ul>
      <li>Better visibility</li>
      <li>Shows current user context when interacting with a callback</li>
    </ul>
  </li>
  <li>More documentation <a href="https://primusinterp.com/PrimusC2/">here</a></li>
  <li>Optimization of backend stuff</li>
  <li>Bug fixes
    <ul>
      <li>Sleep</li>
      <li>pwsh_cradle</li>
    </ul>
  </li>
</ul>

<p>Im going to elaborate on some of the changes in the coming sections. </p>

<h3 id="db-migration"><span class="me-2">DB migration</span><a href="#db-migration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>In order to create a more stable baseline and make it significantly easier to work with data in the backend and frontend, it was necessary to move away from using different data types, such as lists, dicts, tuples etc. and migrate everything over to using a DB instead. I went with SQLite, as this was my first time working with a DB and it turned out to be quite easy and straight forward to work with. With a DB implemented it was also possible to create persistent sessions. This means that listeners can be restarted and old authorization keys can be reused, so any existing implants can talk with the server. With this change you do not have to start over if a fatal exception occurs, instead just restart the server you are back in action.</p>

<p>With the DB implemented, it also enables me to start the improvement of the stability of the framework and handle more exceptions (which is still on my todo).</p>

<h3 id="tcp-implant-disabled"><span class="me-2">TCP implant disabled</span><a href="#tcp-implant-disabled" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>I have decided to disable the TCP implant in this update (the code is still, it is just disabled). My reasoning behind this change is that the TCP version of the implant is quite outdated and clumsy compared to the rest of the implants. I would like to perform a complete rework of it before re-enabling it again.</p>

<h3 id="exe-shellcode-and-dll-compilation"><span class="me-2">EXE, Shellcode and DLL compilation</span><a href="#exe-shellcode-and-dll-compilation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>To expand upon the flexibility of PrimusC2, i have added the option for multiple payload formats that can be generated upon request. This will give the operator the ability to freely choose how to deploy the implant. The DLL is created with the exported function: Ost. The shellcode is created using the <a href="https://github.com/monoxgas/sRDI">sRDI</a> project, that converts a DLL to PIC shellcode.</p>

<p><a href="/assets/img/compile_options.png" class="popup img-link "><img data-src="/assets/img/compile_options.png" alt="compile_options" class="lazyload" data-proofer-ignore></a></p>

<h3 id="docker-compatibility"><span class="me-2">Docker compatibility</span><a href="#docker-compatibility" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>I decided to port the whole project over to a docker setup as well. This is done to make the C2 more usable and portable. You do not have to fight dependencies and weird errors when using this setup. It should work out of the box (famous last words…)</p>

<p>If you find the docker setup to be broken in any way, please let me know.</p>

<h3 id="web-gui-updated"><span class="me-2">Web GUI updated</span><a href="#web-gui-updated" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The web GUI has gotten some additional new features and fixes. The biggest thing is of course that the data is now persistent and stored in the database. But i added some small quality of life stuff, that i want to include here as well. First up is the ability to add notes to each callback, in order to help track callbacks and their data.</p>

<p><a href="/assets/img/Note_CB.gif" class="popup img-link "><img data-src="/assets/img/Note_CB.gif" alt="note_cb" class="lazyload" data-proofer-ignore></a></p>

<p>Additionally, a new feature has been implemented, which i call the “Output Searcher”. It can be used to search trough all the callbacks for a specific command or output that is buried in one of the callbacks. This feature is especially useful when many callbacks have been received and the operator can’t remember in which callback that some specific data is located.</p>

<p><a href="/assets/img/output_searcher.gif" class="popup img-link "><img data-src="/assets/img/output_searcher.gif" alt="output_searcher" class="lazyload" data-proofer-ignore></a></p>

<p>Lastly i also added the callback data in the left corner of the callback screen (see the GIF above), to avoid unessecarry clicking in and out of the interact screen. To accommodate the new compile options, the option to choose between the different ones were added as well.</p>

<h3 id="implant-updates"><span class="me-2">Implant updates</span><a href="#implant-updates" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>This update also contains some new additions to the implants. One of the cooler features added is the <code class="language-plaintext highlighter-rouge">steal_token</code> &amp; <code class="language-plaintext highlighter-rouge">rev2self</code> commands. This will allow the operator to steal and impersonate access tokens from an arbitrary processes (as long as the implant is High integrity). As of now, the implant is not entirely “impersonation aware” (i need to do some research in modifying the existing functionality to be completely impersonation aware). However, in order for the <code class="language-plaintext highlighter-rouge">steal_token</code> functionality not to be useless, i added a new command called <code class="language-plaintext highlighter-rouge">tShell</code>. It will use the stolen token to execute commands via cmd.exe (i know it’s not perfect, but it’s a start). Both the GUI and CLI have been updated to reflect what the current user context is. Lastly, a simple <code class="language-plaintext highlighter-rouge">whoami</code> command was added as well.</p>

<h3 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>This update is not as “sexy” as some of the previous ones, but it has achieved a massive milestone in terms of migrating all data handling to using a DB instead of non-persistent data types. This has laid out the building blocks and helped strengthen the foundation of the project in order to make it durable and easy to work with. Additionally, i did add some other small(but cool) things that mature the project just a tiny bit more. I have plenty of stuff on my internal to-do for the project, so stay tuned for that!</p>

<p>This is it for now. I hope that you will enjoy the update, and I would love to hear your feedback or answer any questions that you might have.</p>

<p>Thanks for reading, and have an excellent day.</p>

<h3 id="roadmap"><span class="me-2">Roadmap</span><a href="#roadmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<ul class="task-list">
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Execute-Assembly</li>
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Encryption of data streams</li>
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Implementation of smart pipe redirectors with automation</li>
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Download functionality for the implant</li>
  <li class="task-list-item"><i class="far fa-circle fa-fw"></i>Upload functionality for the implant</li>
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Directory operations</li>
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>HTTP C2 channel</li>
  <li class="task-list-item"><i class="far fa-circle fa-fw"></i>Improve OPSEC</li>
  <li class="task-list-item"><i class="fas fa-check-circle fa-fw checked"></i>Rework backend to accommodate a database for persistent storage</li>
  <li class="task-list-item"><i class="far fa-circle fa-fw"></i>Evasion techniques</li>
  <li class="task-list-item"><i class="far fa-circle fa-fw"></i>Custom Term Rewriting Macro</li>
  <li class="task-list-item"><i class="far fa-circle fa-fw"></i>Refactor entire code base into multiple files and maybe classes</li>
</ul>

<p><a href="/assets/img/mando.gif" class="popup img-link "><img data-src="/assets/img/mando.gif" alt="mando" class="lazyload" data-proofer-ignore></a>
  </p>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw me-1"></i>
    
      <a href='/categories/primusc2/'>PrimusC2</a>,
      <a href='/categories/updates/'>updates</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw me-1"></i>
      
      <a href="/tags/ad/"
          class="post-tag no-text-decoration" >AD</a>
      
      <a href="/tags/red-team/"
          class="post-tag no-text-decoration" >Red Team</a>
      
      <a href="/tags/c2/"
          class="post-tag no-text-decoration" >C2</a>
      
      <a href="/tags/primusc2/"
          class="post-tag no-text-decoration" >PrimusC2</a>
      
      <a href="/tags/executeassembly/"
          class="post-tag no-text-decoration" >ExecuteAssembly</a>
      
      <a href="/tags/caddy/"
          class="post-tag no-text-decoration" >Caddy</a>
      
      <a href="/tags/redirector/"
          class="post-tag no-text-decoration" >Redirector</a>
      
      <a href="/tags/https/"
          class="post-tag no-text-decoration" >HTTPS</a>
      
      <a href="/tags/steal-token/"
          class="post-tag no-text-decoration" >Steal token</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!-- Post sharing snippet -->

<div class="share-wrapper">
  <span class="share-label text-muted me-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=PrimusC2%20-%20New%20Release%20%7C%20Update%205.0%20-%20.%20.%5CPrimusinterp&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FPrimusC2_update_5.0%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=PrimusC2%20-%20New%20Release%20%7C%20Update%205.0%20-%20.%20.%5CPrimusinterp&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FPrimusC2_update_5.0%2F"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2FPrimusC2_update_5.0%2F&text=PrimusC2%20-%20New%20Release%20%7C%20Update%205.0%20-%20.%20.%5CPrimusinterp"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <i
      id="copy-link"
      class="fa-fw fas fa-link small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
    </i>
  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
      
    </div>
  </div>
  <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
    <div class="access">
      <!-- Get the last 5 posts from lastmod list. -->














  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/PrimusC2_update_4.0/">PrimusC2 - New Release | Update 4.0</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/PrimusC2_update_3.0/">PrimusC2 - New Release | Update 3.0</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/PrimusC2_update/">PrimusC2 - New Release | Update 2.0</a>
        </li>
      
    </ul>
  </div>
  <!-- #access-lastmod -->


      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/red-team/">Red Team</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c2/">C2</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/executeassembly/">ExecuteAssembly</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/primusc2/">PrimusC2</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/caddy/">Caddy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/https/">HTTPS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/redirector/">Redirector</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/certificate/">Certificate</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/info/">info</a>
      
    </div>
  </div>


    </div>

    
      
      



  <div id="toc-wrapper" class="ps-0 pe-4 mb-5">
    <div class="panel-heading ps-3 pt-2 mb-2">Contents</div>
    <nav id="toc"></nav>
  </div>


    
  </div>
</div>

<!-- tail -->

  <div class="row">
    <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5">
      
        
        <!--
  Recommend the other 3 posts according to the tags and categories of the current post,
  if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->








  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  






<!-- Fill with the other newlest posts -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ms-1" data-toc-skip>
      Further Reading
    </h3>
    <div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        
        
        <div class="col">
          <a href="/posts/PrimusC2_update_4.0/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1710802800"
  data-df="ll"
  
>
  Mar 19, 2024
</em>

              <h4 class="pt-0 my-2" data-toc-skip>PrimusC2 - New Release | Update 4.0</h4>
              <div class="text-muted small">
                <p>
                  





                  
Time for another update for PrimusC2. This update do not have as much content as the previous updates, but it has some stuff that greatly improves the maturity of the project.

PrimusC2 Github lin...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        
        
        <div class="col">
          <a href="/posts/PrimusC2_update/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1700348400"
  data-df="ll"
  
>
  Nov 19, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>PrimusC2 - New Release | Update 2.0</h4>
              <div class="text-muted small">
                <p>
                  





                  
I am very happy to have this new update of PrimusC2 released. I have hit some pretty big milestones with the project and done some cool stuff.

PrimusC2 Github link

What’s new:

  File Operations...
                </p>
              </div>
            </div>
          </a>
        </div>
      
        
        
        <div class="col">
          <a href="/posts/PrimusC2_update_3.0/" class="card post-preview h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em
  class="small"
  data-ts="1703372400"
  data-df="ll"
  
>
  Dec 24, 2023
</em>

              <h4 class="pt-0 my-2" data-toc-skip>PrimusC2 - New Release | Update 3.0</h4>
              <div class="text-muted small">
                <p>
                  





                  
I am very happy to have this new update of PrimusC2 released. I have completed a lot of the tasks on the roadmap and made more Qol stuff that makes the C2 more nice to use and work with!

PrimusC2...
                </p>
              </div>
            </div>
          </a>
        </div>
      
    </div>
    <!-- .card-deck -->
  </div>
  <!-- #related-posts -->


      
        
        <!-- Navigation buttons at the bottom of the post. -->

<div class="post-navigation d-flex justify-content-between">
  
    <a
      href="/posts/CRTO/"
      class="btn btn-outline-primary"
      prompt="Older"
    >
      <p>CRTO Review</p>
    </a>
  

  
    <div
      class="btn btn-outline-primary disabled"
      prompt="Newer"
    >
      <p>-</p>
    </div>
  
</div>

      
        
        <!--  The comments switcher -->


      
    </div>
  </div>


        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 post-content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/red-team/">Red Team</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ad/">AD</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c2/">C2</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/executeassembly/">ExecuteAssembly</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/primusc2/">PrimusC2</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/caddy/">Caddy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/https/">HTTPS</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/redirector/">Redirector</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/certificate/">Certificate</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/info/">info</a>
      
    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>
    </div>

    <!-- The Footer -->

<footer>
  <div class="container px-lg-4">
    <div class="d-flex justify-content-center align-items-center text-muted mx-md-3">
      <p>Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>
      </p>

      <p>©
        2024
        <a href="https://twitter.com/AlbertsenOliver">Oliver Albertsen</a>.
        
          <span
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
          >Some rights reserved.</span>
        
      </p>
    </div>
  </div>
</footer>


    <div id="mask"></div>

    <button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow">
      <i class="fas fa-angle-up"></i>
    </button>

    
      <div
        id="notification"
        class="toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-animation="true"
        data-bs-autohide="false"
      >
        <div class="toast-header">
          <button
            type="button"
            class="btn-close ms-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="px-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

